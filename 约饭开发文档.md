
# *约饭开发文档*
React Native 开发的iOS和安卓App 
***
# 主要功能

## 登陆页
微信登陆 调用微信API 

调用API后与后台交互，用户授权后，可以获取用户基本信息，包括头像、昵称、性别、地区。直接采取微信的昵称和头像，个人信息页面提供以上信息更改的功能。

### 首次登陆 
> 取得微信授权后，要求用户输入邮箱，显示微信的默认用户信息，询问用户是否直接保存，提供修改功能。

### 普通登陆 
> 直接微信登陆

### cookie

> 登陆后设置cookie

## 内容主页
### 按条显示约饭内容
> 首先获取用户位置信息，然后发送给后台，后台返回1公里范围内的可约饭条目。如果无法获取用户位置信息如何处理，是否让用户手动选取。
>
> 是返回所有约饭的条目，还是只返回尚未预约的条目。
>
>避免一次请求过多，使用懒加载。
>
>下拉刷新。

### 单条内容应显示
>大约的位置
>
>时间
>
>邀请人头像和昵称

## 从主页进入的单条内容页

### 显示内容
>点击进入后显示邀请人，时间，位置地图。
>
>有可预约按钮
>
>留言


## 个人信息页
### 用户头像
> 后台保存200*200像素的图片，支持png，jpg，bmp格式。可以支持gif，但不支持动图。

### 用户昵称
> 中英文长度2-8个字符，特殊符号支持 _  

### 用户发布的内容
> 按发布时间由近到远 从上到下显示内容。

### 用户预约的内容
> 加入及时聊天功能，网易API

## 个人信息修改页
### 头像修改
> 上传200*200大小的头像

### 昵称修改
> 2-10个字符 

### 密码修改 
> 密码正则匹配验证一下

## 约饭发布页
### 时间
> 24小时制，小时和分钟

### 地点 
> 地图API选取地点
> 
> 首先获取位置信息，显示在地图上，用户可以手动移动位置点，下方显示具体位置，类似朋友圈位置选择。
> 
> 返回GPS坐标和文本位置
 
## 引导逻辑
> 进入后显示主页
> 
> 下方分布三个按钮，左方发布，中间浏览，右边个人信息
> 
> 


***
# 后端 
#### 端口：3000
*加密这一块...先不做吧??我还没用过https/AES/RSA*

### 饭局数据库
1. 发布人 
2. 应邀人 
3. 地点  / GPS坐标和string位置
4. 时间  / 
5. 饭局ID

### 个人信息数据库
1. 用户名
2. 密码
3. 头像(本地文件的路径 & 文件名随机化)
4. 历史未读聊天内容(即时聊天...再说吧)
5. 能有微信号啥的吗...(不了解)
6. 个性签名


### GET
* MainAppointment

> 功能：主页显示的饭局信息
> 
> 参数：GPS位置坐标
> 
> 返回值：TRUE & 当前GPS坐标范围一公里内饭局信息 

* ViewAppointment

>功能：显示用户点击的某条饭局的具体内容
>
>参数：饭局Id
>
>返回值：TRUE & 相应饭局Id的具体内容，JSON格式


* BasicInfo(B)

> 功能: 获取用户基本信息
>
> 参数: 用户名
>
> 返回值: TRUE & 用户的基本信息(用户名/头像<只是一个URL需要再次单独请求>/个签)
>
> FALSE

* AppointmentBegin(AB)

> 功能: 获取已发布饭局信息
>
> 参数: 起始条数. 后端会返回自起始条数起往后50条的信息
>
> 返回值: TRUE & 已发布的饭局
>
> FALSE

* AlterMotto(AM)

> 功能: 修改个性签名
>
> 参数: 新的个性签名
>
> 返回值: TRUE 
>
> FALSE

* AlterPass(AP)

> 功能: 修改密码
>
> 参数: 新密码
>
> 返回值: TRUE
>
> FALSE

* CancleAppointment(CA)

> 功能: 取消饭局
>
> 参数: 饭局ID
>
> 返回值: TRUE & 如果是发布人则删除这个饭局
>
> FALSE

### POST
* UploadAvatar(UA)

> 功能: 上传用户的头像
>
> 参数: 无. 只上传当前用户的头像信息 & 如果已经存在则替换
>
> 数据: 用户头像
>
> 返回值: TRUE
>
> FALSE

* ChatWith(CW)

> 功能: 与某人聊天
>
> 参数: 某人的用户名
>
> 数据: 聊天内容(暂时...不支持emoji吧)
>
> 返回值: 0(成功)
>
> 1(不在线)
>
> 2(其他原因)


* PublishAppointment(PA)

> 功能: 发布饭局
>
> 参数: 无
>
> 数据: 时间
>
> 地点
>
> 返回值: TRUE
>
> FALSE

* DealAppomintent 

> 功能：约定饭局
>
> 数据体样例：
 
    {
    	UId: 
    	AppointmentId:
    }  
> 返回值：成功：TRUE   失败：FALSE && 错误信息 
>

# 其他 

* 注册写入数据库内容


 	    {
           Uid:注册时生成的唯一id,
           email:邮箱,
           name:用户名
  		}
    
	
